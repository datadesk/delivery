<h1 align="center">
  @datadesk/delivery
</h1>
<p align="center">
  <a href="https://www.npmjs.org/package/@datadesk/delivery"><img src="https://badgen.net/npm/v/@datadesk/delivery" alt="npm"></a>
  <a href="https://david-dm.org/datadesk/delivery"><img src="https://badgen.net/david/dep/datadesk/delivery" alt="dependencies"></a>
  <a href="https://packagephobia.now.sh/result?p=@datadesk/delivery"><img src="https://badgen.net/packagephobia/install/@datadesk/delivery" alt="install size"></a>
</p>

`@datadesk/delivery` is a way to push and pull assets to and from S3 the Data Desk way!

## Installation

`@datadesk/delivery` is available via `npm`.

```sh
npm install -D @datadesk/delivery
```

## Usage

TK TK

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [Delivery](#delivery)
    -   [Parameters](#parameters)
    -   [uploadFile](#uploadfile)
        -   [Parameters](#parameters-1)
    -   [uploadFiles](#uploadfiles)
        -   [Parameters](#parameters-2)
    -   [downloadFile](#downloadfile)
        -   [Parameters](#parameters-3)
    -   [downloadFiles](#downloadfiles)
        -   [Parameters](#parameters-4)
-   [How outputs are structured](#how-outputs-are-structured)
-   [Output](#output)
    -   [Key](#key)
    -   [isIdentical](#isidentical)
-   [DownloadOutput](#downloadoutput)
-   [UploadOutput](#uploadoutput)
    -   [isPublic](#ispublic)
    -   [size](#size)

### Delivery

**Extends EventEmitter**

The base class for @datadesk/delivery. Create an instance of Delivery to set
an interface with S3.

#### Parameters

-   `options` **{bucket: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String), basePath: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)}** 
    -   `options.bucket`  The bucket on S3 to interact with
    -   `options.basePath`  A pre-defined base path for all interactions with S3.
                                Good for establishing the slug of an upload. (optional, default `''`)

#### uploadFile

Uploads a single file to S3.

##### Parameters

-   `file` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The path to the file to upload
-   `path` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Where to upload the file relative to the base path
-   `options` **{isPublic: [boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?, shouldCache: [boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?}**  (optional, default `{}`)
    -   `options.isPublic`  Whether a file should be made public or not on upload (optional, default `false`)
    -   `options.shouldCache`  Whether a file should have cache headers applied (optional, default `false`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[UploadOutput](#uploadoutput)>** 

#### uploadFiles

Upload a directory of files to S3.

##### Parameters

-   `dir` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The directory to upload to S3
-   `options` **{prefix: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?, isPublic: [boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?, shouldCache: [boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?}**  (optional, default `{}`)
    -   `options.prefix`  The prefix to add to the uploaded file's path (optional, default `''`)
    -   `options.isPublic`  Whether all files uploaded should be made public (optional, default `false`)
    -   `options.shouldCache`  Whether all files uploaded should get cache headers (optional, default `false`)

#### downloadFile

Downloads a file from S3 to the local disk.

##### Parameters

-   `path` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The path to the file to download
-   `dest` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Where to put the file on the local disk
-   `options` **{s3ETag: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?}**  (optional, default `{}`)
    -   `options.s3ETag`  If the ETag from S3 is already known, it can be provided here

#### downloadFiles

Downloads multiple files from a prefix on S3.

##### Parameters

-   `prefix` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The prefix to the directory on S3 to download from
-   `dir` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Where to put all the files on the local disk

### How outputs are structured

These represent the output objects from Delivery's commands.


### Output

The base output of both downloaded and uploaded files.

#### Key

The file's path on S3.

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

#### isIdentical

Whether the file was identical on S3 or locally and was skipped.

Type: [boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

### DownloadOutput

**Extends Output**

What downloadFile and downloadFiles returns. Identical to [Output](#output).

### UploadOutput

**Extends Output**

What uploadFile and uploadFiles returns. Includes [Output](#output)'s fields.

#### isPublic

This file was made public on upload.

Type: [boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)

#### size

The size of the uploaded file in bytes.

Type: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)

## License

MIT
